@isTest
public class TamsSprCMPCTRLTest {
	public static testmethod void testTamsSprCMPCTRL() {
		System.debug('START:testTamsSprCMPCTRL');
        Account acc = new Account(name='Test Account');
        acc.Territory_Name_TAMS__c = 'US.GL.2660100.TR-101';
        insert acc;

        Opportunity op1 = new Opportunity();
        op1.Name='testOpName1';
        op1.Expected_Bill_Date_TAMS__c = Date.today() + 2;
        op1.CloseDate =  Date.today()+1;
        op1.StageName = 'Closed/Lost';
        op1.Lost_Cancelled_Reason_TAMS__c = 'Functionality/Insufficient Technology';
        op1.Competitor_Lost_to_TAMS__c = 'GE';
        op1.LeadSource = 'Cold Call';
        op1.Incumbent_TAMS__c = 'GE';
        op1.Competitor_Lost_to_TAMS__c = 'GE';
        op1.Is_this_Product_Funded_TAMS__c = 'Yes';
        op1.Additional_Comments_TAMS__c = 'Test Comments';
        op1.Actual_Book_Date_TAMS__c = Date.today();
        insert op1;        

        TAMS_Quotes__c quote1 = new TAMS_Quotes__c();
        quote1.Opportunity_Name__c = op1.id;
        quote1.Customer_Name__c    = acc.id;
        quote1.Modality__c         = 'CT';
        quote1.PBOM__c             = 'AQ64/VELOCT/UPG.000';
        quote1.Quote_Name__c       = 'TriggerTestQuote1';
        quote1.Quote_Version__c    = '1';
        quote1.Status__c           = 'Quote Generated by HQ';
        quote1.Amount__c           = 4000;
        insert quote1;
        Test.startTest();
        String response = TamsSprCMPCTRL.createSPR(quote1.id);
        Test.stopTest();
        System.debug('response:'+response);
        List<TAMS_Special_Pricing_Request__c> spr = [SELECT name,id 
	        										FROM TAMS_Special_Pricing_Request__c
	        										WHERE TAMS_Quote_SPR__c =:quote1.id  ];

		System.debug('spr size:'+spr.size());
		System.assert(spr.size() == 1 , 'Spr not created.');		        											
		if(spr.size() == 1){
			List<SPR_Quote__c> sprQ = [SELECT Name,id FROM SPR_Quote__c
										WHERE TAMS_SPR__c = :spr[0].id];
			System.assert(sprQ.size() == 1 , 'Spr Quote not created.');		        																		
		}
	}
}